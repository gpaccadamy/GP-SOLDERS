<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Video Lessons</title>
  <link rel="icon" href="data:,">
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #667eea, #764ba2); color: #333; margin: 0; padding: 0; }
    header { background: rgba(0,0,0,0.8); color: white; padding: 15px 20px; display: flex; align-items: center; position: fixed; width: 100%; z-index: 1000; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
    header h1 { flex-grow: 1; text-align: center; margin: 0; }
    .main { margin-top: 80px; padding: 20px; max-width: 900px; margin-left: auto; margin-right: auto; }
    .card { background: white; border-radius: 16px; padding: 30px; margin-bottom: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
    .action-btn { background: linear-gradient(to right, #667eea, #764ba2); color: white; padding: 14px; border: none; border-radius: 12px; font-size: 16px; cursor: pointer; width: 100%; margin: 10px 0; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { padding: 14px; text-align: left; border-bottom: 1px solid #eee; }
    th { background: #f0f0f5; }
    select, input { width: 100%; padding: 14px; margin: 10px 0; border: 1px solid #ddd; border-radius: 10px; font-size: 16px; }
  </style>
</head>
<body>
  <header><h1>Admin Panel - Video Lessons</h1></header>
  <div class="main">
    <div class="card">
      <h2>Add New Video Lesson</h2>
      <select id="vSubject">
        <option value="">Select Subject</option>
        <option value="english">English</option>
        <option value="kannada">Kannada</option>
        <option value="gk">GK</option>
        <option value="maths">Maths</option>
      </select>
      <select id="vClass">
        <option value="">Select Class</option>
        <option value="1">Class 1</option>
        <option value="2">Class 2</option>
        <option value="3">Class 3</option>
        <option value="4">Class 4</option>
        <option value="5">Class 5</option>
        <option value="6">Class 6</option>
      </select>
      <input type="text" id="vUrl" placeholder="Full YouTube Link">
      <input type="text" id="vTitle" placeholder="Title (optional)">
      <button class="action-btn" onclick="saveVideo()">Save Video</button>
    </div>

    <div class="card">
      <h2>Uploaded Videos</h2>
      <table>
        <thead><tr><th>Subject</th><th>Class</th><th>Title</th></tr></thead>
        <tbody id="videosList"></tbody>
      </table>
    </div>
  </div>

  <script>
    const API_URL = "https://academy-backend-e02j.onrender.com";

    async function loadVideos() {
      const res = await fetch(`${API_URL}/videos`);
      const data = await res.json();
      document.getElementById('videosList').innerHTML = data.map(v => `
        <tr><td>${v.subject}</td><td>${v.class}</td><td>${v.title || 'No title'}</td></tr>
      `).join('');
    }

    async function saveVideo() {
      const subject = document.getElementById('vSubject').value;
      const classNum = document.getElementById('vClass').value;
      const youtubeUrl = document.getElementById('vUrl').value.trim();
      const title = document.getElementById('vTitle').value.trim();
      if (!subject || !classNum || !youtubeUrl) return alert("Subject, class and URL are required");
      const res = await fetch(`${API_URL}/videos`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ subject, classNum, youtubeUrl, title })
      });
      const data = await res.json();
      alert(data.message || data.error);
      loadVideos();
    }

    loadVideos();
  </script>
</body>
</html>
